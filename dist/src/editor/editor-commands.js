"use strict"
define(["mathlive/core/lexer","mathlive/core/mathAtom","mathlive/core/parser","mathlive/core/span","mathlive/editor/editor-shortcuts","mathlive/addons/outputLatex"],function(t,e,a,r,i){var l=[{label:"&#x21e0",cls:"glyph",ariaLabel:"Left",shortcut:"none",selector:"moveToPreviousChar",utility:1004},{label:"&#x21e2",cls:"glyph",ariaLabel:"Right",shortcut:"none",selector:"moveToNextChar",utility:1003},{label:"&#x21e5",cls:"glyph",ariaLabel:"Tab",shortcut:"none",selector:"moveToNextPlaceholder",utility:1002,condition:o},{label:"&#x232b",cls:"glyph",ariaLabel:"Backspace",shortcut:"none",selector:"deletePreviousChar",utility:1001},{label:"Copy as LaTeX",shortcut:["mac:Meta-KeyC","!mac:Ctrl-KeyC"],selector:["copyToClipboard"],condition:s,utility:900},{label:"Fraktur",dynamicLabel:"\\mathfrak{#0}",selector:["insert","\\mathfrak{#0}"],condition:m,utility:400},{label:"Calligraphic",dynamicLabel:"\\mathcal{#0}",selector:["insert","\\mathcal{#0}"],condition:m,utility:400},{label:"Blackboard",dynamicLabel:"\\mathbb{#0}",selector:["insert","\\mathbb{#0}"],condition:m,utility:500},{label:"Script",dynamicLabel:"\\mathscr{#0}",selector:["insert","\\mathscr{#0}"],condition:m,utility:300},{label:"Sans Serif",dynamicLabel:"\\mathsf{#0}",selector:["insert","\\mathsf{#0}"],condition:u,utility:100},{label:"Typewriter",dynamicLabel:"\\mathtt{#0}",selector:["insert","\\mathtt{#0}"],condition:s,utility:100},{label:"Bold",dynamicLabel:"\\mathbf{#0}",selector:["insert","\\mathbf{#0}"],condition:s,utility:400},{label:"Vector",dynamicLabel:"\\vec{#0}",selector:["insert","\\vec{#0}",{selectionMode:"item"}],condition:h,utility:400},{label:"Bar",dynamicLabel:"\\bar{#0}",selector:["insert","\\bar{#0}"],condition:h,utility:300},{label:"Superscript",dynamicLabel:'#0^\\unicode{"2B1A}',shortcut:"^",selector:"moveToSuperscript",condition:y,arg:n,utility:700},{label:"Subscript",dynamicLabel:'#0_\\unicode{"2B1A}',shortcut:"_",selector:"moveToSubscript",condition:y,arg:n,utility:500},{label:"Command",shortcut:"\\",selector:"enterCommandMode",condition:o,utility:800},{label:"Complete",selector:"complete",shortcut:"Return",condition:c,utility:800}]
function n(t,e,a){var r=void 0
if(a&&a.length>0)r=a
else if(e&&e.length>0){r=[]
for(var i=e.length-1;i>=0&&"mord"===e[i].type&&/[0-9\.]/.test(e[i].value);)r.unshift(e[i]),i-=1
0===r.length&&r.push(e[e.length-1])}return r}function o(t,e,a,r,i,l){return!l&&"command"!==t}function c(t){return"command"===t}function s(t,e,a,r,i,l){return null!==l}function u(t,e,a,r,i,l){var n=!1
if(l){n=1===l.filter(function(t){return"mord"===t.type&&/^[A-Z0-9]$/.test(t.value)}).length}return n}function m(t,e,a,r,i,l){var n=!1
if(l){n=1===l.filter(function(t){return"mord"===t.type&&/^[A-Z]$/.test(t.value)}).length}return n}function h(t,e,a,r,i,l){var n=!1
if(l){n=1===l.filter(function(t){return"mord"===t.type&&/^[a-zA-Z]$/.test(t.value)}).length}return n}function y(t,e,a,r,i){var l=!1
if(i&&(!r||"root"===r.type)){var n=i[i.length-1]
l="mclose"===n.type||"mord"===n.type,l=l&&"â€‹"!==n.value}return l}var d={commands:{delete:{count:100,timestamps:{keyboard:333,button:3553}}}}
function b(t,e,a,r,n,o,c){var s=[],u=!0,m=!1,h=void 0
try{for(var y,d=l[Symbol.iterator]();!(u=(y=d.next()).done);u=!0){var b=y.value
if(!b.condition||b.condition(t,e,a,r,n,o,c)){var p=b.label||"",f=b.shortcut||i.getShortcutsForCommand(b.selector),v=f&&"none"!==f?i.stringify(f):""
if(b.dynamicLabel){p='<span class="ML__dynamicLabel">'+L(b.dynamicLabel,b.arg?b.arg(r,n,o,c):o)+"</span>",b.label&&(p+='<span class="ML__shortLabel">'+b.label+'<span class="ML__keyboardShortcut">'+v+"</span>")}else v&&(p+='<span class="ML__keyboardShortcut">'+v+"</span>")
s.push({label:p,cls:b.cls,ariaLabel:b.ariaLabel,selector:b.selector,utility:b.utility})}}}catch(t){m=!0,h=t}finally{try{!u&&d.return&&d.return()}finally{if(m)throw h}}return s.sort(function(t,e){return e.utility-t.utility}),s}function p(){}function f(){}function v(){return d}function L(i,l){var n=[]
if(l&&l.length>0){var o="",c=!0,s=!1,u=void 0
try{for(var m,h=l[Symbol.iterator]();!(c=(m=h.next()).done);c=!0){o+=m.value.toLatex()}}catch(t){s=!0,u=t}finally{try{!c&&h.return&&h.return()}finally{if(s)throw u}}n.push(a.parseTokens(t.tokenize(o),"math"))}var y=a.parseTokens(t.tokenize(i),"math",n),d=e.decompose({mathstyle:"displaystyle"},y),b=r.makeSpan(d,"ML__base"),p=r.makeSpan("","ML__strut")
p.setStyle("height",b.height,"em")
var f=r.makeSpan("","ML__strut ML__bottom")
return f.setStyle("height",b.height+b.depth,"em"),f.setStyle("vertical-align",-b.depth,"em"),r.makeSpan([p,f,b],"ML__mathlive").toMarkup()}return{suggest:b,record:p,loadUserStats:f,saveUserStats:v}})
